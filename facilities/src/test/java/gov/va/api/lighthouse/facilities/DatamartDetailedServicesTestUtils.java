package gov.va.api.lighthouse.facilities;

import static gov.va.api.lighthouse.facilities.collector.CovidServiceUpdater.CMS_OVERLAY_SERVICE_NAME_COVID_19;
import static java.util.Collections.emptyList;

import gov.va.api.lighthouse.facilities.api.TypeOfService;
import java.util.List;
import java.util.stream.Collectors;
import lombok.NonNull;
import lombok.experimental.UtilityClass;

@UtilityClass
public class DatamartDetailedServicesTestUtils {
  public static DatamartDetailedService datamartDetailedServiceWithEmptyAttributes() {
    return DatamartDetailedService.builder()
        .serviceInfo(
            DatamartDetailedService.ServiceInfo.builder()
                .serviceId(DatamartFacility.HealthService.Covid19Vaccine.serviceId())
                .name(CMS_OVERLAY_SERVICE_NAME_COVID_19)
                .serviceType(TypeOfService.Health)
                .build())
        .phoneNumbers(emptyList())
        .serviceLocations(emptyList())
        .build();
  }

  public static DatamartDetailedService
      datamartDetailedServiceWithInvalidServiceIdEmptyAttributes() {
    return DatamartDetailedService.builder()
        .serviceInfo(
            DatamartDetailedService.ServiceInfo.builder()
                .serviceId("emptyService")
                .serviceType(TypeOfService.Health)
                .build())
        .phoneNumbers(emptyList())
        .serviceLocations(emptyList())
        .build();
  }

  public static DatamartDetailedService
      datamartDetailedServiceWithInvalidServiceIdNullAttributes() {
    return DatamartDetailedService.builder()
        .serviceInfo(
            DatamartDetailedService.ServiceInfo.builder()
                .serviceId("emptyService")
                .serviceType(TypeOfService.Health)
                .build())
        .phoneNumbers(null)
        .serviceLocations(null)
        .build();
  }

  public static DatamartDetailedService datamartDetailedServiceWithNullAttributes() {
    return DatamartDetailedService.builder()
        .serviceInfo(
            DatamartDetailedService.ServiceInfo.builder()
                .serviceId(DatamartFacility.HealthService.Covid19Vaccine.serviceId())
                .name(CMS_OVERLAY_SERVICE_NAME_COVID_19)
                .serviceType(TypeOfService.Health)
                .build())
        .phoneNumbers(null)
        .serviceLocations(null)
        .build();
  }

  public static List<DatamartDetailedService> datamartDetailedServices(boolean isActive) {
    return getDatamartDetailedServices(
        List.of(
            DatamartFacility.HealthService.Cardiology,
            DatamartFacility.HealthService.Covid19Vaccine,
            DatamartFacility.HealthService.Urology),
        isActive);
  }

  private DatamartDetailedService getDatamartDetailedService(
      @NonNull DatamartFacility.HealthService healthService, boolean isActive) {
    return DatamartDetailedService.builder()
        .serviceInfo(
            DatamartDetailedService.ServiceInfo.builder()
                .serviceId(healthService.serviceId())
                .name(
                    DatamartFacility.HealthService.Covid19Vaccine.equals(healthService)
                        ? CMS_OVERLAY_SERVICE_NAME_COVID_19
                        : healthService.name())
                .serviceType(healthService.serviceType())
                .build())
        .active(isActive)
        .changed(null)
        .appointmentLeadIn("Your VA health care team will contact you if you...more text")
        .path("replaceable path here")
        .phoneNumbers(
            List.of(
                DatamartDetailedService.AppointmentPhoneNumber.builder()
                    .extension("123")
                    .label("Main phone")
                    .number("555-555-1234")
                    .type("tel")
                    .build()))
        .serviceLocations(
            List.of(
                DatamartDetailedService.DetailedServiceLocation.builder()
                    .serviceAddress(
                        DatamartDetailedService.DetailedServiceAddress.builder()
                            .buildingNameNumber("Baxter Building")
                            .wingFloorOrRoomNumber("Wing East")
                            .address1("122 Main St.")
                            .address2(null)
                            .city("Rochester")
                            .state("NY")
                            .zipCode("14623-1345")
                            .countryCode("US")
                            .build())
                    .phoneNumbers(
                        List.of(
                            DatamartDetailedService.AppointmentPhoneNumber.builder()
                                .extension("567")
                                .label("Alt phone")
                                .number("556-565-1119")
                                .type("tel")
                                .build()))
                    .emailContacts(
                        List.of(
                            DatamartDetailedService.DetailedServiceEmailContact.builder()
                                .emailAddress("georgea@va.gov")
                                .emailLabel("George Anderson")
                                .build()))
                    .serviceHours(
                        DatamartDetailedService.DetailedServiceHours.builder()
                            .monday("8:30AM-7:00PM")
                            .tuesday("8:30AM-7:00PM")
                            .wednesday("8:30AM-7:00PM")
                            .thursday("8:30AM-7:00PM")
                            .friday("8:30AM-7:00PM")
                            .saturday("8:30AM-7:00PM")
                            .sunday("CLOSED")
                            .build())
                    .additionalHoursInfo("Please call for an appointment outside...")
                    .onlineSchedulingAvailable("True")
                    .referralRequired("True")
                    .walkInsAccepted("False")
                    .officeName("ENT Clinic")
                    .build()))
        .build();
  }

  private List<DatamartDetailedService> getDatamartDetailedServices(
      @NonNull List<DatamartFacility.HealthService> healthServices, boolean isActive) {
    return healthServices.stream()
        .map(
            hs -> {
              return getDatamartDetailedService(hs, isActive);
            })
        .collect(Collectors.toList());
  }
}
